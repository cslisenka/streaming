define("welcome_res/lib/Login",["client"],function(d){function a(b){c(b||"Unexpected error. Trying again.");setTimeout(function(){f()},1E3)}function e(a){h=a;h==g?c("Room is full, you can't play, but you can watch"):h==b?document.getElementById("messageDiv").style.display="none":h==k?c("Entering room"):c("Connection Lost")}function f(){e(k);var c="Guest"+Math.ceil(100*Math.random());d.sendMessage("n|"+c,"Nick",3E3,{onAbort:function(c,b){a()},onDeny:function(c,f,d){-2720==f?(e(b),m(d,!1)):-2700==f?
(e(g),m(d,!0)):a(d)},onDiscarded:function(c){a()},onError:function(c){a()},onProcessed:function(a){e(b);m(c,!1)}})}function c(c){document.getElementById("messageDiv").innerHTML=c}var b=2,g=3,k=4,h=1;d.addListener({onListenStart:function(){this.onStatusChange(d.getStatus())},onStatusChange:function(c){0==c.indexOf("CONNECTED:")||"STALLED"==c?1==h&&f():1!=h&&(e(1),l())}});var m=function(){},l=function(){};return{init:function(c,b){m=c||m;l=b||l}}});
define("welcome_res/lib/Player",["Subscription","client"],function(d,a){var e=function(a,c){this.nick=a.getValue("key");this.message=a.getValue("msg");this.isBall=0==this.nick.indexOf("Ball-");this.appended=!1;this.divMsg=this.messageEl=this.posX=this.posY=this.avatar=this.sub=this.div=null;c?(this.randomNum=2,this.color="#950000"):(this.randomNum=4,this.color="#757575")};e.prototype={getColor:function(){return this.color},makeAvatar:function(a,c,b){this.avatar||this.div&&!b||(this.avatar=document.createElement("div"),
this.isBall?(this.avatar.className="divBall",this.avatar.style.width="31px",this.avatar.style.height="31px",b=document.createElement("div"),c=document.createElement("img"),c.src="welcome_res/img/ball.png",c.style.border="0",c.style.width="31px",c.style.height="31px"):(this.avatar.className="divPerson",this.avatar.style.width="20px",this.avatar.style.height="46px",b=document.createElement("div"),c=document.createElement("img"),c.src="welcome_res/img/person-"+(9>=this.randomNum?"0"+this.randomNum:this.randomNum)+
".png",c.style.border="0",c.style.width="20px",c.style.height="46px"),b.appendChild(c),this.avatar.appendChild(b),this.room=a,this.goTo(this.posX,this.posY))},goTo:function(a,c){this.posX=null===a?this.posX:a;this.posY=null===c?this.posY:c;if(null!==this.posX||null!==this.posY){var b=this.avatar;if(b){var e=0!==b.offsetHeight?b.offsetHeight:this.isBall?31:46,d=0!==b.offsetWidth?b.offsetWidth:this.isBall?31:20;this.isBall?(b.style.left=this.posX-d/2+"px",b.style.top=this.posY-e/2+"px"):(b.style.left=
this.posX-d+"px",b.style.top=this.posY-e+"px");!this.appended&&this.room&&(this.room.appendChild(b),this.appended=!0)}}},removeAvatar:function(){this.avatar&&(this.avatar.parentNode&&this.avatar.parentNode.removeChild(this.avatar),this.room=this.avatar=null)},subscribe:function(e){this.sub||(this.sub=new d("MERGE",this.nick,["posX","posY"]),this.sub.setRequestedSnapshot("yes"),e&&this.sub.setRequestedMaxFrequency("unfiltered"),this.sub.addListener(this),a.subscribe(this.sub))},unsubscribe:function(){this.sub&&
(a.unsubscribe(this.sub),this.sub=null)},updatePlayer:function(a){this.goTo(a.getValue("posX"),a.getValue("posY"))}};return e});
define("welcome_res/lib/Buddies",["./Player"],function(d){var a=function(a,d,c){(this.unfilteredPlayers=a)&&alert("WARNING: unfiltered players!");this.msnry=this.container=this.me=this.status=null;this.room=d;this.singleSub=c;this.players={}};a.prototype={setOwnerNick:function(a){this.me=a;null!=a&&this.players[a]&&this.setOwnerColor()},positionBuddies:function(){2!=this.status&&(this.status=2);this.makeAvatars()},noBuddies:function(){3==this.status&&(this.status=3);this.clearAvatars()},clearAvatars:function(){for(var a in this.players)this.players[a].removeAvatar(this.msnry);
this.players={}},makeAvatars:function(){for(var a in this.players)this.players[a].makeAvatar(this.room,this.msnry)},subscribeAll:function(){if(!this.singleSub)for(var a in this.players)this.players[a].subscribe(this.unfilteredPlayers)},onUnsubscription:function(){this.clearTiles();this.clearAvatars();this.unsubscribeAll();this.players={}},onItemUpdate:function(a){if("ADD"==a.getValue("command")){var f=a.getValue("key"),c=new d(a,f==this.me);this.players[f]=c;this.singleSub||c.subscribe(this.unfilteredPlayers);
c.makeAvatar(this.room,this.msnry)}else if("DELETE"==a.getValue("command")){f=this.players[a.getValue("key")];this.singleSub||f.unsubscribe();delete this.players[a.getValue("key")];f.removeAvatar(this.msnry);return}this.players[a.getValue("key")].updatePlayer(a)}};return a});
define("welcome_res/lib/AxisControl",["client"],function(d){function a(a){var c=d.getStatus();"STALLED"!=c&&0!=c.indexOf("CONNECTED:")||d.sendMessage(a,"InputKey",1E3)}var e=function(a,c){this.key1=a;this.key2=c;this.going2=this.going1=!1};e.prototype={goOne:function(){this.going2&&(this.going2=!1,a(10*this.key2));this.going1||(this.going1=!0,a(this.key1))},stopOne:function(){this.going1&&(this.going1=!1,a(10*this.key1))},goTwo:function(){this.going1&&(this.going1=!1,a(10*this.key1));this.going2||
(this.going2=!0,a(this.key2))},stopTwo:function(){this.going2&&(this.going2=!1,a(10*this.key2))},stop:function(){this.going1?(this.going1=!1,a(10*this.key1)):this.going2&&(this.going2=!1,a(10*this.key2))}};return e});
define("welcome_res/lib/KeyPad",["./AxisControl"],function(d){function a(a,c,b){b=b||document.body;"undefined"!=typeof b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent("on"+a,c);return!0}function e(a){if(!n&&!l){var c=window.event?event.keyCode:a.keyCode,c=c||a.which;switch(c){case 87:g.goOne();break;case 68:b.goOne();break;case 83:g.goTwo();break;case 65:b.goTwo()}}}function f(a){var c=window.event?event.keyCode:a.keyCode,c=c||a.which;switch(c){case 87:g.stopOne();break;case 68:b.stopOne();
break;case 83:g.stopTwo();break;case 65:b.stopTwo()}}function c(a){if(!p&&!l){var c=window.event?event.keyCode:a.keyCode,c=c||a.which;switch(c){case 84:k();break;case 82:k(!0)}}}var b=new d(39,37),g=new d(38,40),k=function(){},h=!1,m=!1,l=!1,n=!0,p=!1;return{disableIfFocusOn:function(c){a("focus",function(){l=!0},c);a("blur",function(){l=!1},c)},startListening:function(){h||(a("keyup",f),a("keydown",e),h=!0);n=!1},stopListening:function(){g.stop();b.stop();n=!0},listenMasterCommands:function(b){m||
(m=!0,a("keydown",c));k=b||k;p=!1},stopMasterCommands:function(){p=!0}}});
define("welcome_res/lib/Buttons",["./AxisControl"],function(d){function a(a,c,b){for(var d=0;d<a.length;d++)evnt=a[d],c.addEventListener?c.addEventListener(evnt,b,!1):c.attachEvent("on"+evnt,b)}function e(a,c,b,d){return function(){a.idle||(d?b?c.stopOne():c.stopTwo():b?c.goOne():c.goTwo())}}var f=["mousedown","touchstart","touchenter"],c=["mouseup","touchend","touchcancel","touchleave","mouseout"],b=function(b,k,h,m){var l=new d(39,37),n=new d(38,40);this.buttons={up:document.getElementById(b),down:document.getElementById(k),
left:document.getElementById(h),right:document.getElementById(m)};a(f,this.buttons[b],e(this,n,!0,!1));a(f,this.buttons[k],e(this,n,!1,!1));a(f,this.buttons[m],e(this,l,!0,!1));a(f,this.buttons[h],e(this,l,!1,!1));a(c,this.buttons[b],e(this,n,!0,!0));a(c,this.buttons[k],e(this,n,!1,!0));a(c,this.buttons[m],e(this,l,!0,!0));a(c,this.buttons[h],e(this,l,!1,!0));this.stopListening()};b.prototype={startListening:function(){this.idle=!1},stopListening:function(){this.idle=!0}};return b});
var hostToUse="file:"==document.location.protocol?"http://localhost:8080":document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:"");
define("client",["LightstreamerClient","StatusWidget"],function(d,a){var e=new d(hostToUse,"WELCOME");e.addListener(new a("left","20px",!1));e.addListener({onStatusChange:function(a){0==a.indexOf("CONNECTED")?document.getElementById("welcomeMsg").innerHTML="\x3cspan class\x3d'ok'\x3eCongratulations! Your Lightstreamer Server is up and running.\x3c/span\x3e":0==a.indexOf("DISCONNECTED")&&(document.getElementById("welcomeMsg").innerHTML="\x3cspan class\x3d'ko'\x3eOops! Can't connect to Lightstreamer Server. Please check your configuration.\x3c/span\x3e")}});
e.connect();return e});
require(["client","Subscription","DynaGrid"],function(d,a,e){var f=new e("stocks",!0);e=f.extractFieldList();f.setSort("stock_name");f.setNodeTypes(["div","span","img"]);f.setAutoCleanBehavior(!0,!1);f.addListener({onVisualUpdate:function(a,b,d){null!=b&&(b.setHotTime(300),b.setHotToColdTime(200),d=b.getChangedFieldValue("last_price"),null!==d?(a=f.getValue(a,"last_price"),!a||d>a?b.setAttribute("#90EE90","rgb(182, 207, 135)","backgroundColor"):b.setAttribute("#ECE981","rgb(182, 207, 135)","backgroundColor"),
b.setCellValue("last_price",formatDecimal(d,2,!0))):b.setAttribute("#90EE90","rgb(182, 207, 135)","backgroundColor"),b.setCellAttribute("arrow","","","backgroundColor"),a=b.getChangedFieldValue("pct_change"),null!==a&&(a=formatDecimal(a,2,!0)+"%",-1<a.indexOf("-")?(b.setCellValue("arrow","./welcome_res/img/quotes_down.gif"),b.setCellAttribute("pct_change","#444","#DD0000","color"),b.setCellValue("pct_change",a)):(b.setCellValue("arrow","./welcome_res/img/quotes_up.gif"),b.setCellAttribute("pct_change",
"#444","#009900","color"),b.setCellValue("pct_change","+"+a))),a=b.getChangedFieldValue("time"),null!==a&&b.setCellValue("time",formatTime(a)),a=b.getChangedFieldValue("min"),null!==a&&b.setCellValue("min",formatDecimal(a,2,!0)),a=b.getChangedFieldValue("max"),null!==a&&b.setCellValue("max",formatDecimal(a,2,!0)))}});a=new a("MERGE","item1 item2 item3 item4 item5 item6".split(" "),e);a.addListener(f);a.setDataAdapter("STOCKS");a.setRequestedSnapshot("yes");d.subscribe(a)});
require(["client","Subscription","Chart","StaticGrid","SimpleChartListener"],function(d,a,e,f,c){f=new f("data",!0);f.setAutoCleanBehavior(!0,!1);f.addListener({onVisualUpdate:function(a,b){if(null!=b){var c=b.getChangedFieldValue("TIME");null!=c&&b.setCellValue("TIME",c/1E3);c=b.getChangedFieldValue("Speed");null!=c&&(c=Math.round(0.621371*c),b.setCellValue("Speed",c));c=b.getChangedFieldValue("Distance");null!=c&&(c=formatDecimal(0.621371*c,2,!0),b.setCellValue("Distance",c))}}});var b=new e("speedChart",
!0);b.setAutoCleanBehavior(!0,!1);b.setXAxis("Distance");b.addYAxis("Speed");b.addListener(new c(2,20));b.addListener({onNewLine:function(a,c,b,d){c.setStyle("#fff","#fff",1,1)},onRemovedLine:function(){b.positionXAxis(0,0)}});var g=new e("rpmChart",!0);g.setAutoCleanBehavior(!0,!1);g.setXAxis("Distance");g.addYAxis("Rpm");g.addListener(new c(2,3));g.addListener({onNewLine:function(a,c,b,d){c.setStyle("#ECE981","#ECE981",1,1)},onRemovedLine:function(){g.positionXAxis(0,0)}});a=new a("MERGE","P_driver_1",
["TIME","Speed","Rpm","Gear_output","Distance"]);a.setDataAdapter("TELEMETRY");a.setRequestedSnapshot("yes");a.addListener(f);a.addListener(g);a.addListener(b);d.subscribe(a)});
require(["client","Subscription","DynaGrid"],function(d,a,e){var f=new e("messages",!0);f.setMaxDynaRows("unlimited");f.setAutoScroll("ELEMENT","chatInnerContainer");f.setAutoCleanBehavior(!0,!1);f.addListener({associated:{},next:0,colors:"#FFFFE0 #FFEBCD #F0F8FF #CCFFCC #FFF5EE #E0FFFF #F0FFF0 #F0E68C #87CEEB #E6E6FA #FFB6C1 #F5FFFA #FFFAFA #F5F5DC #F8F8FF #FFE4E1 #D8BFD8 #FFF0F5 #EEE8AA".split(" "),onVisualUpdate:function(a,b,d){null!=b&&(a=b.getCellValue("nick"),b=b.getCellValue("IP")+"_"+a,a=
this.associated[b],a||(this.associated[b]=this.colors[this.next],this.next=this.next>=this.colors.length?0:this.next+1,a=this.associated[b]),d.style.backgroundColor=a)}});a=new a("DISTINCT","chat_room",f.extractFieldList());a.setDataAdapter("CHAT");a.setRequestedSnapshot(30);a.addListener(f);a.addListener({onClearSnapshot:function(a,b){var d=new Date,d=[pad2(d.getHours()),pad2(d.getMinutes()),pad2(d.getSeconds())].join(":");f.updateRow(1,{timestamp:d,message:"Chat history flushed... Let's keep it clean"})}});
d.subscribe(a)});var lsclient=null;require(["client"],function(d){lsclient=d;d.addListener({onStatusChange:function(a){0==a.indexOf("CONNECTED")?document.getElementById("chatButton").disabled=!1:document.getElementById("chatButton").disabled=!0}})});function chatSubmitForm(){var d=document.getElementById("chatInput");if(window.lsclient&&d){var a=d.value;a&&a!=document.getElementById("chatInput").placeholder&&(lsclient.sendMessage("CHAT|"+a),d.value="",d.focus())}}
document.getElementById("roomContainer")&&require("client Subscription welcome_res/lib/Login welcome_res/lib/Buddies welcome_res/lib/KeyPad welcome_res/lib/Buttons".split(" "),function(d,a,e,f,c,b){var g=new f(!1,document.getElementById("roomContainer"),!0),k=new a("COMMAND","Players_list","command key nick msg usrAgnt posX posY 1Plot.SymbolName".split(" "));k.setDataAdapter("ROOMBALL");k.setRequestedSnapshot("yes");k.addListener(g);var h=new b("up","down","left","right");c.disableIfFocusOn(document.getElementById("chatInput"));
e.init(function(a,b){b||(g.setOwnerNick(a),c.startListening(),h.startListening());d.subscribe(k);g.positionBuddies()},function(){g.noBuddies();g.setOwnerNick(null);c.stopListening();h.stopListening()})});function formatTime(d){var a=new Number(d.substring(0,d.indexOf(":")));12<a&&(a-=12);d=d.substring(d.indexOf(":"),d.length);return a+d}
function formatDecimal(d,a,e){for(var f=new String("1"),c=new String("0"),b=a;0<b;b--)f+=c;d=Math.round(d*f);d=new String(d/f);if(!e)return d;e=0;b=d.indexOf(".");-1==b?d+=".":e=d.length-b-1;for(b=e;b<a;b++)d+=c;return d}
function moreBrowsers(){var d="LSDemoWindow"+Math.floor(1E4*Math.random()),a=Math.round(window.screen.availWidth/2),e=Math.floor(70*Math.random()),f=window.innerHeight-e,c=Math.round(window.screen.availWidth/2+(70*Math.random()-35));window.open("index.html",d,"location\x3dyes,scrollbars\x3dyes,resizable\x3dyes,width\x3d"+a+",height\x3d"+f+",left\x3d"+c+",top\x3d"+e)}
function checkURL(){return"file:"==location.protocol?(alert("To open the Monitoring Dashboard, get this page from your Lightstreamer Server via http, not from file. See GETTING_STARTED.TXT for full instructions."),!1):!0}function pad2(d){return(10>d?"0":"")+d}define("welcome_res/lib/index",function(){});
